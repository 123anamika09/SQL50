
-- select person_name from Queue
-- where sum(weigth) = 1000  
-- This is invalid because WHERE works row by row, and SUM(weight) is an aggregate over multiple rows.
-- SQL doesnâ€™t know how to apply SUM() directly in WHERE.


select person_name from (
    select person_name ,sum(weight) over (order by turn) as running_weight from queue
) t

where running_weight <= 1000 
order by running_weight desc
limit 1;
